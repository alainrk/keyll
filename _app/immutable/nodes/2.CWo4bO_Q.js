function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
var M=Object.defineProperty;var F=(i,a,s)=>a in i?M(i,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[a]=s;var o=(i,a,s)=>(F(i,typeof a!="symbol"?a+"":a,s),s);import{s as H,e as E,c as q,b as P,f as g,o as p,i as Q,y as O,n as x,z as j,r as N,a as W,l as U,g as G,h as V,v as B}from"../chunks/scheduler.CyYm8BkD.js";import{S as z,i as D,b as K,d as J,m as X,a as Y,t as Z,e as $}from"../chunks/index.CziIskVE.js";import{_ as ee}from"../chunks/preload-helper.BQ24v_F8.js";const te=!0,de=Object.freeze(Object.defineProperty({__proto__:null,prerender:te},Symbol.toStringTag,{value:"Module"}));function ae(i){let a,s,r;return{c(){a=E("div"),this.h()},l(n){a=q(n,"DIV",{style:!0,class:!0}),P(a).forEach(g),this.h()},h(){p(a,"style",i[0]),p(a,"class","m-0")},m(n,l){Q(n,a,l),s||(r=O(i[1].call(null,a)),s=!0)},p(n,[l]){l&1&&p(a,"style",n[0])},i:x,o:x,d(n){n&&g(a),s=!1,r()}}}function re(i,a){return a.forEach(([s,r])=>i[s]=r),i}function se(i,a,s){let{target:r=void 0}=a,{sketch:n=void 0}=a,{parentDivStyle:l="display: block;"}=a,{debug:h=!1}=a,d;const C=j(),b={ref(){C("ref",r)},instance(){C("instance",d)}};function _(u){return s(2,r=u),{destroy(){s(2,r=void 0)}}}return N(async()=>{const u=await ee(()=>import("../chunks/p5.min.EDYTDBRi.js").then(t=>t.p),__vite__mapDeps([]),import.meta.url),{default:v}=u,e=Object.entries(u).filter(([t,m])=>m instanceof Function&&t[0]!=="_"&&t!=="default");h&&console.log("available p5 native classes",e),d=new v(t=>(t=re(t,e),h&&console.log("p5 instance",t),window._p5Instance=t,n(t)),r),b.ref(),b.instance()}),i.$$set=u=>{"target"in u&&s(2,r=u.target),"sketch"in u&&s(3,n=u.sketch),"parentDivStyle"in u&&s(0,l=u.parentDivStyle),"debug"in u&&s(4,h=u.debug)},[l,_,r,n,h]}class ne extends z{constructor(a){super(),D(this,a,se,ae,H,{target:2,sketch:3,parentDivStyle:0,debug:4})}}function ie(i){let a,s,r,n,l;return n=new ne({props:{sketch:i[1]}}),{c(){a=E("meta"),s=W(),r=E("div"),K(n.$$.fragment),this.h()},l(h){const d=U("svelte-1cozuwq",document.head);a=q(d,"META",{name:!0,content:!0}),d.forEach(g),s=G(h),r=q(h,"DIV",{id:!0});var C=P(r);J(n.$$.fragment,C),C.forEach(g),this.h()},h(){document.title="Keyll",p(a,"name","description"),p(a,"content","Keyll Touch Typing Trainer"),p(r,"id","game-canvas-parent")},m(h,d){V(document.head,a),Q(h,s,d),Q(h,r,d),X(n,r,null),i[2](r),l=!0},p:x,i(h){l||(Y(n.$$.fragment,h),l=!0)},o(h){Z(n.$$.fragment,h),l=!1},d(h){h&&(g(s),g(r)),g(a),$(n),i[2](null)}}}function he(i,a,s){let r,n;const l="abcdefghijklmnopqrstuvwxyz",h="ABCDEFGHIJKLMNOPQRSTUVWXYZ",d="0123456789",C="!@#$%^&*()_+~-=`{}[]|:;'\"<>,.?/\\",b=new Set(`${l}${h}${d}${C}`.split(""));class _{constructor(t=10){o(this,"queue");o(this,"maxLength");this.queue=[],this.maxLength=t}updateCurrent(t){this.queue.length>0&&(this.queue[this.queue.length-1].hit=t)}addChar(t,m,c=!1){let f;return this.queue.length>0&&(this.queue[this.queue.length-1].current=!1),this.queue.push({char:t,hit:m,upcoming:c,current:!0}),this.queue.length>this.maxLength&&(f=this.queue.shift()),f}getString(){return this.queue.map(t=>t.char).join("")}getLastChar(){return this.queue[this.queue.length-1]}}class u{constructor(){o(this,"hitCount",0);o(this,"totCount",0);o(this,"missedChar",!1);o(this,"enableLowerCase",!0);o(this,"enableUpperCase",!1);o(this,"enableNumbers",!1);o(this,"enableSpecial",!1);o(this,"availableChars");o(this,"charset");o(this,"typedCharsQueue");o(this,"promptedCharsQueue");o(this,"upcomingCharsQueue");this.availableChars=this.createAvailableChars(),this.charset=new Set(this.availableChars.split("")),this.typedCharsQueue=new _(45),this.promptedCharsQueue=new _(11),this.upcomingCharsQueue=new _(10);for(let t=0;t<10;t++)this.upcomingCharsQueue.addChar(this.getRandomCharFromCharSet(),!1,!0);this.updateChar()}get currentChar(){return this.promptedCharsQueue.getLastChar().char}get currentCharIsHit(){return this.promptedCharsQueue.getLastChar().hit}updateChar(){const t=this.upcomingCharsQueue.addChar(this.getRandomCharFromCharSet(),!1,!0);t&&(this.promptedCharsQueue.addChar(t.char,!0),this.totCount++)}handleTypedChar(t){if(t===r.currentChar){this.currentCharIsHit&&this.hitCount++,this.missedChar=!1,this.updateChar(),this.typedCharsQueue.addChar(t,!0),this.promptedCharsQueue.updateCurrent(!0);return}this.missedChar=!0,this.promptedCharsQueue.updateCurrent(!1),b.has(t)&&this.typedCharsQueue.addChar(t,!1)}createAvailableChars(){let t="";return this.enableLowerCase&&(t+=l),this.enableUpperCase&&(t+=h),this.enableNumbers&&(t+=d),this.enableSpecial&&(t+=C),t}getRandomCharFromCharSet(){return this.availableChars[Math.floor(Math.random()*this.availableChars.length)]}}const v=e=>{e.setup=()=>{const t=e.createCanvas(n.clientWidth,e.windowHeight/2);console.log(`Created canvas with size: ${t.width}x${t.height} in element ${n.id}.`),e.noStroke(),e.background(0),e.textFont("Courier New"),e.frameRate(10),r=new u},e.draw=()=>{let t=[];const m=(c,f,S,R=e.LEFT)=>{R===e.RIGHT&&(S=S.slice().reverse());var y=c;for(let w=0;w<S.length;++w){const L=S[w],k=L[0],I=L[1],A=e.textWidth(k);e.fill(...I),e.text(k,y,f),R===e.LEFT?y+=A:y-=A}};e.background(0),e.fill(255),e.textSize(25),e.text(`Score: ${r.hitCount}/${r.totCount}`,20,40),e.textSize(50),t=[];for(const c of r.promptedCharsQueue.queue){if(c.current)continue;const f=c.hit?[0,200,0,100]:[200,0,0,100];t.push([c.char,f])}m(e.width/2-65,e.height/2+20,t,e.RIGHT),r.missedChar?e.fill(255,0,0):e.fill(255,255,255),e.textSize(100),e.textStyle(e.BOLD),e.text(r.currentChar,e.width/2-e.textWidth(r.currentChar)/2,e.height/2+e.textWidth(r.currentChar)/3),e.textStyle(e.NORMAL),e.textSize(50),t=[];for(const c of r.upcomingCharsQueue.queue){const f=c.hit?[250,250,250,100]:[250,250,250,100];t.push([c.char,f])}m(e.width/2+35,e.height/2+20,t),e.textSize(25),t=[];for(const c of r.typedCharsQueue.queue){const f=c.hit?[0,200,0]:[200,0,0];t.push([c.char,f])}m(20,e.height-20,t)},e.keyPressed=()=>{r.handleTypedChar(e.key)}};function T(e){B[e?"unshift":"push"](()=>{n=e,s(0,n)})}return[n,v,T]}class fe extends z{constructor(a){super(),D(this,a,he,ie,H,{})}}export{fe as component,de as universal};
